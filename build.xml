<!-- ant build file for VirtualLabs -->

<project name="VirtualLabs" default="web" basedir="." >

	<!-- Properties -->

	<property name="src" value="src"/>
	<property name="build" value="build"/>
	<property name="build.classes" value="${build}/classes"/>
	<property name="build.applets" value="${build}/applets"/>
	<property name="web" value="web"/>
	<property name="product" value="product"/>

	<property environment="env"/>

	<!-- Targets -->

	<!-- Prepare build directories -->
	<target name="init">
		<mkdir dir="${build}"/>
		<mkdir dir="${build.classes}"/>
		<mkdir dir="${build.applets}"/>
		<mkdir dir="${product}"/>
		<condition property="compilerargs" value="-Xlint:all,-serial">
			<equals arg1="${env.DEBUG}" arg2="debug"/>
		</condition>
	</target>

	<!-- Kill all the created directories -->
	<target name="clean">
		<delete dir="${build}"/>
		<delete dir="${product}"/>
	</target>

	<!-- Moran -->
	<target name="Moran" depends="init">
		<property name="applet" value="Moran"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<ant antfile="core.xml" target="dapplet">
			<property name="build.classes" value="${builddir}"/>
		</ant>
	</target>

	<target name="cleanMoran" depends="init">
		<property name="applet" value="Moran"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<delete dir="${builddir}"/>
		<delete file="${build.applets}/${applet}.jar"/>
	</target>

	<!-- 2x2 -->
	<target name="2x2" depends="init">
		<property name="applet" value="2x2"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<ant antfile="core.xml" target="dapplet">
			<property name="build.classes" value="${builddir}"/>
		</ant>
	</target>

	<target name="clean2x2" depends="init">
		<property name="applet" value="2x2"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<delete dir="${builddir}"/>
		<delete file="${build.applets}/${applet}.jar"/>
	</target>

	<!-- public goods -->
	<target name="PGG" depends="init">
		<property name="applet" value="PublicGoods"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<ant antfile="core.xml" target="dapplet">
			<property name="build.classes" value="${builddir}"/>
		</ant>
	</target>

	<target name="cleanPGG" depends="init">
		<property name="applet" value="PublicGoods"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<delete dir="${builddir}"/>
		<delete file="${build.applets}/${applet}.jar"/>
	</target>

	<!-- voluntary public goods -->
	<target name="CDL" depends="init">
		<property name="applet" value="CDL"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<ant antfile="core.xml" target="dapplet">
			<property name="build.classes" value="${builddir}"/>
		</ant>
	</target>

	<target name="cleanCDL" depends="init">
		<property name="applet" value="CDL"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<delete dir="${builddir}"/>
		<delete file="${build.applets}/${applet}.jar"/>
	</target>

	<!-- voluntary public goods with punishment -->
	<target name="CDLP" depends="init">
		<property name="applet" value="CDLP"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<ant antfile="core.xml" target="dapplet">
			<property name="build.classes" value="${builddir}"/>
		</ant>
	</target>

	<target name="cleanCDLP" depends="init">
		<property name="applet" value="CDLP"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<delete dir="${builddir}"/>
		<delete file="${build.applets}/${applet}.jar"/>
	</target>

	<!-- ecological public goods -->
	<target name="EcoPGG" depends="init">
		<property name="applet" value="EcoPGG"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<ant antfile="core.xml" target="dapplet">
			<property name="build.classes" value="${builddir}"/>
		</ant>
	</target>

	<target name="cleanEcoPGG" depends="init">
		<property name="applet" value="EcoPGG"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<delete dir="${builddir}"/>
		<delete file="${build.applets}/${applet}.jar"/>
	</target>

	<!-- punishment & reputation -->
	<target name="Punishment" depends="init">
		<property name="applet" value="Punishment"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<ant antfile="core.xml" target="dapplet">
			<property name="build.classes" value="${builddir}"/>
		</ant>
	</target>

	<target name="cleanPunishment" depends="init">
		<property name="applet" value="Punishment"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<delete dir="${builddir}"/>
		<delete file="${build.applets}/${applet}.jar"/>
	</target>

	<!-- reward & reputation -->
	<target name="Reward" depends="init">
		<property name="applet" value="Reward"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<ant antfile="core.xml" target="dapplet">
			<property name="build.classes" value="${builddir}"/>
		</ant>
	</target>

	<target name="cleanReward" depends="init">
		<property name="applet" value="Reward"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<delete dir="${builddir}"/>
		<delete file="${build.applets}/${applet}.jar"/>
	</target>

	<!-- continuous snowdrift -->
	<target name="CSD" depends="init">
		<property name="applet" value="CSD"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<ant antfile="core.xml" target="capplet">
			<property name="build.classes" value="${builddir}"/>
		</ant>
	</target>

	<target name="cleanCSD" depends="init">
		<property name="applet" value="CSD"/>
		<property name="builddir" value="${build.classes}/${applet}"/>
		<delete dir="${builddir}"/>
		<delete file="${build.applets}/${applet}.jar"/>
	</target>

	<!-- build web tutorials -->
	<target name="web" depends="web-2x2,web-PGG,web-CDL,web-CDLP,web-RePun,web-CSD,web-general">
		<copy todir="${product}/images">
			<fileset dir="${web}/images"/>
		</copy>
		<copy todir="${product}" file="${web}/favicon.ico"/>
		<copy todir="${product}" file="${web}/index.html"/>
	</target>

	<target name="web-general" depends="web-style">
		<copy todir="${product}/General">
			<fileset dir="${web}/General"/>
		</copy>
	</target>

	<target name="web-style">
		<copy todir="${product}/styles">
			<fileset dir="${web}/styles"/>
		</copy>
	</target>

	<target name="web-Moran" depends="Moran,2x2,web-style">
		<property name="tutorial" value="Moran"/>
		<copy todir="${product}/${tutorial}">
			<fileset dir="${web}/${tutorial}"/>
		</copy>
		<copy todir="${product}/${tutorial}" file="${build.applets}/Moran.jar"/>
		<copy todir="${product}/${tutorial}" file="${build.applets}/2x2.jar"/>
	</target>

	<target name="web-2x2" depends="2x2,web-style">
		<property name="tutorial" value="TwoByTwo"/>
		<copy todir="${product}/${tutorial}">
			<fileset dir="${web}/${tutorial}"/>
		</copy>
		<copy todir="${product}/${tutorial}" file="${build.applets}/2x2.jar"/>
	</target>

	<target name="web-PGG" depends="PGG,web-style">
		<property name="tutorial" value="PublicGoods"/>
		<copy todir="${product}/${tutorial}">
			<fileset dir="${web}/${tutorial}"/>
		</copy>
		<copy todir="${product}/${tutorial}" file="${build.applets}/PublicGoods.jar"/>
	</target>

	<target name="web-CDL" depends="CDL,web-style">
		<property name="tutorial" value="Volunteering"/>
		<copy todir="${product}/${tutorial}">
			<fileset dir="${web}/${tutorial}"/>
		</copy>
		<copy todir="${product}/${tutorial}" file="${build.applets}/CDL.jar"/>
	</target>

	<target name="web-CDLP" depends="CDLP,web-style">
		<property name="tutorial" value="VolPun"/>
		<copy todir="${product}/${tutorial}">
			<fileset dir="${web}/${tutorial}"/>
		</copy>
		<copy todir="${product}/${tutorial}" file="${build.applets}/CDLP.jar"/>
	</target>

	<target name="web-RePun" depends="Reward,Punishment,web-style">
		<property name="tutorial" value="RewardAndPunishment"/>
		<copy todir="${product}/${tutorial}">
			<fileset dir="${web}/${tutorial}"/>
		</copy>
		<copy todir="${product}/${tutorial}" file="${build.applets}/Reward.jar"/>
		<copy todir="${product}/${tutorial}" file="${build.applets}/Punishment.jar"/>
	</target>

	<target name="web-CSD" depends="CSD,web-style">
		<property name="tutorial" value="Branching"/>
		<copy todir="${product}/${tutorial}">
			<fileset dir="${web}/${tutorial}"/>
		</copy>
		<copy todir="${product}/${tutorial}" file="${build.applets}/CSD.jar"/>
	</target>

</project>

